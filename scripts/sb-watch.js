"use strict";const _=require("lodash"),chokidar=require("chokidar"),path=require("path"),renderAssets=require("./render-assets"),renderPug=require("./render-pug"),renderScripts=require("./render-scripts"),renderSCSS=require("./render-scss"),watcher=chokidar.watch("src",{persistent:!0});let READY=!1;process.title="pug-watch",process.stdout.write("Loading");let allPugFiles={};function _processFile(e,r){return READY?(console.log(`### INFO: File event: ${r}: ${e}`),e.match(/\.pug$/)?_handlePug(e,r):e.match(/\.scss$/)?"change"===r?_handleSCSS(e,r):void 0:e.match(/src\/js\//)?renderScripts():e.match(/src\/assets\//)?renderAssets():void 0):(e.match(/\.pug$/)&&(e.match(/includes/)||e.match(/mixins/)||e.match(/\/pug\/layouts\//)||(allPugFiles[e]=!0)),void process.stdout.write("."))}function _handlePug(e,r){return"change"===r?e.match(/includes/)||e.match(/mixins/)||e.match(/\/pug\/layouts\//)?_renderAllPug():renderPug(e):e.match(/includes/)||e.match(/mixins/)||e.match(/\/pug\/layouts\//)?void 0:renderPug(e)}function _renderAllPug(){console.log("### INFO: Rendering All"),_.each(allPugFiles,((e,r)=>{renderPug(r)}))}function _handleSCSS(){renderSCSS()}watcher.on("add",(e=>_processFile(e,"add"))),watcher.on("change",(e=>_processFile(e,"change"))),watcher.on("ready",(()=>{READY=!0,console.log(" READY TO ROLL!")})),_handleSCSS();
